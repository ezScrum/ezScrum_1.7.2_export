*** Settings ***
Suite Setup
Suite Teardown
Resource          keywords/common_resource.txt
Resource          keywords/Export/ezScrum_Export_SetupTeardown.txt
Resource          keywords/ezScrum_Login.txt
Resource          keywords/Export/ezScrum_Export.txt
Resource          Global Define.txt
Library           keywords/lib/JSONFileComparator.py

*** Test Cases ***
Test Export - Export and Compare With Golden Answer
    [Setup]    Test Export Setup
    # 登入ezScrum
    Login Page    ${LOGIN_URL}
    # 進入 Management 頁面
    Click Element    xpath=//td[text()="Management"]
    Wait Until Page Contains Element    xpath=//div[@id="Management_Top_Panel"]//td[text()="Account Management"]
    # 切換到 Export 頁面
    Switch To Item Link    False    Export
    #
    Choose Project By Name    Project01
    # 按下 Export 按鈕
    Click Element    //table[@id = 'exportButton']//button[text() = 'Export']
    # 等待成功訊息視窗顯示
    Wait Until Page Contains    Your data is downloaded!
    # 驗證檔案格式及內容
    ${are_files_the_same} =    Compare JSON File    C:/Users/ibmboy/Desktop/2015-12-22-1551_ezScrum_export.json    C:/workspace/ezScrum_1.7.2_export/robotTesting/TestData/golden_answer.json
    Should Be True    ${are_files_the_same}    The JSON files are not the same
    [Teardown]    Test Export Teardown
